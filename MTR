<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>468 è¨ˆç®—å™¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: "Microsoft JhengHei", Arial, sans-serif; margin: 20px; background: #f4f6f8; }
    h1 { text-align: center; margin-bottom: 10px; }
    .reminder {
      background: #fff3cd;
      border: 1px solid #ffeeba;
      padding: 12px;
      margin-bottom: 20px;
      border-radius: 6px;
      color: #856404;
    }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
    th { background: #0078d7; color: white; }
    tr:nth-child(even) { background: #f9f9f9; }
    input { width: 70px; padding: 5px; text-align: center; }
    button { 
      padding: 10px 15px; font-size: 1em; 
      background: #0078d7; color: white; border: none; border-radius: 6px;
      margin: 5px;
    }
    button:active { background: #005a9e; }
    .ok { color: green; font-weight: bold; }
    .warning { color: red; font-weight: bold; }
    .section-title { margin-top: 20px; font-size: 1.2em; font-weight: bold; }
  </style>
</head>
<body>
  <h1>468 è¨ˆç®—å™¨</h1>

  <!-- æ–°è¦å®šæé†’å€å¡Š -->
  <div class="reminder">
    <strong>ğŸ“Œ æé†’ï¼š</strong><br>
    ã€Œé€£çºŒæ€§åˆç´„ã€æ–°è¦å®šè‡ª <strong>2026å¹´1æœˆ18æ—¥</strong> èµ·é©ç”¨ã€‚<br><br>
    åƒ±å“¡å¦‚ç¬¦åˆä»¥ä¸‹æ¢ä»¶ï¼Œå³å±¬ã€Œé€£çºŒæ€§åˆç´„ã€ï¼š<br>
    1ï¸âƒ£ é€£çºŒå—åƒ±æ–¼åŒä¸€åƒ±ä¸»å››æ˜ŸæœŸæˆ–ä»¥ä¸Šï¼›<br>
    2ï¸âƒ£ å·¥æ™‚ç¬¦åˆä»¥ä¸‹å…¶ä¸­ä¸€é …ï¼š<br>
    â€‘ æ¯æ˜ŸæœŸæœ€å°‘å·¥ä½œ <strong>17å°æ™‚</strong>ï¼›æˆ–<br>
    â€‘ è‹¥æŸæ˜ŸæœŸå°‘æ–¼17å°æ™‚ï¼Œå‰‡è©²æ˜ŸæœŸé€£åŒéå»ä¸‰æ˜ŸæœŸåˆå…±å››æ˜ŸæœŸä¸å°‘æ–¼ <strong>68å°æ™‚ï¼ˆ468æº–å‰‡ï¼‰</strong>ã€‚<br><br>
    âš ï¸ æ³¨æ„ï¼šæ–°å…¥è·é¦–ä¸‰æ˜ŸæœŸå¿…é ˆæ¯é€±è‡³å°‘17å°æ™‚ï¼Œ468æº–å‰‡ä¸é©ç”¨ã€‚<br>
    èˆŠè¦å®šï¼ˆ2026å¹´1æœˆ18æ—¥å‰ï¼‰ï¼šæ¯é€±æœ€å°‘18å°æ™‚ã€‚
  </div>

  <div>
    <button onclick="prevWindow()">â—€ ä¸Šä¸€é </button>
    <button onclick="nextWindow()">ä¸‹ä¸€é  â–¶</button>
  </div>
  <div id="weeks"></div>

  <div class="section-title">416 è¨ˆç®—å™¨çµæœ</div>
  <div id="output416"></div>

  <div class="section-title">468 è¨ˆç®—å™¨çµæœ</div>
  <div id="output468"></div>

  <script>
    const weeks = 52;
    const weeklyCap = 16;
    const fourWeekCap = 67.5;
    const startDate = new Date("2025-12-28");
    let currentWindowStart = 1;

    function formatDate(date) {
      return date.getFullYear() + "/" +
             (date.getMonth()+1).toString().padStart(2,"0") + "/" +
             date.getDate().toString().padStart(2,"0");
    }

    function renderWindow() {
      const container = document.getElementById("weeks");
      let html = `<table>
        <thead>
          <tr>
            <th>é€±æ•¸</th>
            <th>æ—¥æœŸç¯„åœ</th>
            <th>å·¥æ™‚</th>
          </tr>
        </thead>
        <tbody>`;
      for (let i = currentWindowStart; i < currentWindowStart+4 && i <= weeks; i++) {
        let weekStart = new Date(startDate);
        weekStart.setDate(startDate.getDate() + (i-1)*7);
        let weekEnd = new Date(weekStart);
        weekEnd.setDate(weekStart.getDate() + 6);

        html += `
          <tr>
            <td>${i}</td>
            <td>${formatDate(weekStart)} - ${formatDate(weekEnd)}</td>
            <td><input type="number" id="w${i}" value="0" min="0" max="168" oninput="calculate()"></td>
          </tr>`;
      }
      html += `</tbody></table>`;
      container.innerHTML = html;
    }

    function nextWindow() {
      if (currentWindowStart + 4 <= weeks) {
        currentWindowStart++;
        renderWindow();
        calculate();
      }
    }
    function prevWindow() {
      if (currentWindowStart > 1) {
        currentWindowStart--;
        renderWindow();
        calculate();
      }
    }

    function calculate() {
      let weeklyTotals = [];
      for (let i = currentWindowStart; i < currentWindowStart+4 && i <= weeks; i++) {
        let sum = parseFloat(document.getElementById(`w${i}`).value) || 0;
        weeklyTotals.push(sum);
      }

      // 416 è¨ˆç®—å™¨çµæœ
      let table416 = `<table>
        <tr><th>é€±æ•¸</th><th>å·¥æ™‚</th><th>å‰©é¤˜OT</th><th>ç‹€æ…‹</th></tr>`;
      for (let i = 0; i < weeklyTotals.length; i++) {
        let remainingWeeklyOT = weeklyCap - weeklyTotals[i];
        let weeklyClass = remainingWeeklyOT < 0 ? "warning" : "ok";
        let statusMsg = weeklyTotals[i] > weeklyCap 
          ? `<span class="warning">âš ï¸ è¶…é16å°æ™‚ï¼Œä¸å…è¨±</span>` 
          : `<span class="ok">ç¬¦åˆè¦å®š</span>`;
        table416 += `<tr>
          <td>${currentWindowStart+i}</td>
          <td class="${weeklyTotals[i] >= 17 ? 'ok' : 'warning'}">${weeklyTotals[i]}</td>
          <td class="${weeklyClass}">${remainingWeeklyOT}</td>
          <td>${statusMsg}</td>
        </tr>`;
      }
      table416 += `</table>`;
      document.getElementById("output416").innerHTML = table416;

      // 468 è¨ˆç®—å™¨çµæœ
      let fourWeekSum = weeklyTotals.reduce((a,b)=>a+b,0);
      let remainingFourWeekOT = fourWeekCap - fourWeekSum;
      let fourWeekClass = remainingFourWeekOT < 0 ? "warning" : "ok";
      let statusMsg468 = remainingFourWeekOT < 0 
        ? `<span class="warning">âš ï¸ è¶…é468æº–å‰‡ï¼</span>` 
        : `<span class="ok">ç¬¦åˆè¦å®š</span>`;

      let table468 = `<table>
        <tr><th>é€±æ•¸ç¯„åœ</th><th>å››é€±ç¸½å·¥æ™‚</th><th>å‰©é¤˜å››é€±OT</th><th>ç‹€æ…‹</th></tr>
        <tr>
          <td>${currentWindowStart} - ${currentWindowStart+weeklyTotals.length-1}</td>
          <td class="${fourWeekSum >= fourWeekCap ? 'ok' : 'warning'}">${fourWeekSum}</td>
          <td class="${fourWeekClass}">${remainingFourWeekOT}</td>
          <td>${statusMsg468}</td>
        </tr>
      </table>`;
      document.getElementById("output468").innerHTML = table468;
    }

    renderWindow();
    calculate(); // åˆå§‹å³æ™‚é¡¯ç¤º
  </script>
</body>
</html>
